<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-i18n="title">Prédicas - Iglesia Bautista Fundamental Betesda</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-white">
    <!-- Header -->
    <header class="bg-black py-4 px-6 fixed w-full z-50">
        <nav class="flex items-center justify-between max-w-7xl mx-auto">
            <div class="flex items-center">
                <img src="img/1.png" alt="Logo de la Iglesia" class="h-24 w-24 rounded-full">
                <span class="text-[#BF9B30] ml-3 text-xl font-semibold">IBFB</span>
            </div>
            <div class="hidden md:flex space-x-8">
                <a href="index.html#home" class="text-white hover:text-[#BF9B30]" data-i18n="nav-home">Inicio</a>
                <a href="index.html#recursos" class="text-white hover:text-[#BF9B30]" data-i18n="nav-resources">Recursos</a>
                <a href="index.html#services" class="text-white hover:text-[#BF9B30]" data-i18n="nav-services">Servicios</a>
                <a href="index.html#sermones" class="text-white hover:text-[#BF9B30]" data-i18n="nav-sermons">Sermones</a>
                <a href="index.html#eventos" class="text-white hover:text-[#BF9B30]" data-i18n="nav-events">Eventos</a>
                <a href="index.html#contact" class="text-white hover:text-[#BF9B30]" data-i18n="nav-contact">Contacto</a>
            </div>
            <button id="lang-toggle" class="text-white border border-[#BF9B30] px-4 py-2 rounded hover:bg-[#BF9B30]" data-i18n="lang-toggle">ES/EN</button>
        </nav>
    </header>

    <!-- Main Content -->
    <section class="pt-32 pb-12 px-6 bg-gray-100">
        <div class="max-w-7xl mx-auto">
            <h1 class="text-4xl font-bold text-center mb-8 text-black" data-i18n="sermons-title">Prédicas</h1>
            <div class="mb-8 flex flex-col md:flex-row justify-between items-center space-y-4 md:space-y-0 md:space-x-4">
                <input type="text" id="search-input" placeholder="Buscar por nombre..." class="w-full md:w-1/2 p-3 border border-gray-300 rounded focus:outline-none focus:border-[#BF9B30]" data-i18n-placeholder="search-placeholder">
                <select id="sort-select" class="w-full md:w-1/4 p-3 border border-gray-300 rounded focus:outline-none focus:border-[#BF9B30]">
                    <option value="desc" data-i18n="sort-recent">Más reciente primero</option>
                    <option value="asc" data-i18n="sort-oldest">Más antiguo primero</option>
                </select>
            </div>
            <div id="resource-grid" class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
                <!-- Los videos se cargarán aquí dinámicamente -->
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-black text-white py-12 px-6">
        <div class="max-w-7xl mx-auto grid md:grid-cols-3 gap-8">
            <div>
                <h3 class="text-[#BF9B30] text-xl font-semibold mb-4" data-i18n="footer-location">Ubicación</h3>
                <p data-i18n="footer-location-desc">Cuenca, Ecuador</p>
            </div>
            <div>
                <h3 class="text-[#BF9B30] text-xl font-semibold mb-4" data-i18n="footer-contact">Contacto</h3>
                <p data-i18n="footer-contact-email">Correo: contact@ibfb.org</p>
                <p data-i18n="footer-contact-phone">Teléfono: +593 123 456 789</p>
            </div>
            <div>
                <h3 class="text-[#BF9B30] text-xl font-semibold mb-4" data-i18n="footer-follow">Síguenos</h3>
                <div class="flex space-x-4">
                    <a href="#" class="hover:text-[#BF9B30]" data-i18n="footer-social-facebook">Facebook</a>
                    <a href="#" class="hover:text-[#BF9B30]" data-i18n="footer-social-youtube">YouTube</a>
                    <a href="#" class="hover:text-[#BF9B30]" data-i18n="footer-social-instagram">Instagram</a>
                </div>
            </div>
        </div>
        <div class="mt-8 text-center text-gray-400">
            <p data-i18n="footer-copyright">&copy; 2025 Iglesia Bautista Fundamental Betesda. Todos los derechos reservados.</p>
        </div>
    </footer>

    <!-- JavaScript -->
    <script>
        // === Configuración ===
        const channelId = "UCLs1hNc80aCzFbhsQAbhHzQ";
        const rssUrl = `https://www.youtube.com/feeds/videos.xml?channel_id=${channelId}`;
        const apiUrl = `https://api.rss2json.com/v1/api.json?rss_url=${encodeURIComponent(rssUrl)}`;

        const resourceGrid = document.getElementById("resource-grid");

        // === Cargar videos ===
        async function loadVideos() {
            try {
                const res = await fetch(apiUrl);
                const data = await res.json();

                resourceGrid.innerHTML = "";

                data.items.forEach(item => {
                    const videoId = item.link.split("v=")[1];
                    const date = new Date(item.pubDate).toISOString().split("T")[0];

                    const card = document.createElement("div");
                    card.className = "resource-card bg-white rounded-lg shadow-lg p-6";
                    card.setAttribute("data-name", item.title);
                    card.setAttribute("data-date", date);

                    card.innerHTML = `
                        <h3 class="text-xl font-semibold mb-2">${item.title}</h3>
                        <p class="text-gray-600 mb-4">Fecha: ${date}</p>
                        <iframe width="100%" height="315" src="https://www.youtube.com/embed/${videoId}" frameborder="0" allowfullscreen></iframe>
                        <a href="https://www.youtube.com/watch?v=${videoId}" target="_blank" class="mt-4 inline-block bg-[#BF9B30] text-white px-4 py-2 rounded hover:bg-black">Ver en YouTube</a>
                    `;
                    resourceGrid.appendChild(card);
                });

                filterAndSortResources();
            } catch (error) {
                console.error("Error al cargar videos:", error);
                resourceGrid.innerHTML = "<p class='text-red-500'>No se pudieron cargar los videos.</p>";
            }
        }

        // === Filtrar y ordenar ===
        const searchInput = document.getElementById("search-input");
        const sortSelect = document.getElementById("sort-select");

        function filterAndSortResources() {
            const searchTerm = searchInput.value.toLowerCase();
            const sortOrder = sortSelect.value;
            const cards = Array.from(document.getElementsByClassName("resource-card"));

            let filteredCards = cards.filter(card =>
                card.getAttribute("data-name").toLowerCase().includes(searchTerm)
            );

            filteredCards.sort((a, b) => {
                const dateA = new Date(a.getAttribute("data-date"));
                const dateB = new Date(b.getAttribute("data-date"));
                return sortOrder === "asc" ? dateA - dateB : dateB - dateA;
            });

            resourceGrid.innerHTML = "";
            filteredCards.forEach(card => resourceGrid.appendChild(card));
        }

        searchInput.addEventListener("input", filterAndSortResources);
        sortSelect.addEventListener("change", filterAndSortResources);

        // === Inicializar ===
        loadVideos();
    </script>
</body>
</html>
