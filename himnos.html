<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-i18n="title">Música Cristiana - Iglesia Bautista Fundamental Betesda</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-white">

<!-- ================= HEADER ================= -->
<header class="bg-black py-4 px-6 fixed w-full z-50">
    <nav class="flex items-center justify-between max-w-7xl mx-auto">
        <div class="flex items-center">
            <img src="img/1.png" alt="Logo Iglesia" class="h-24 w-24 rounded-full">
            <span class="text-[#BF9B30] ml-3 text-xl font-semibold">IBFB</span>
        </div>

        <div class="hidden md:flex space-x-8">
            <a href="index.html#home" class="text-white hover:text-[#BF9B30]" data-i18n="nav-home">Inicio</a>
            <a href="index.html#recursos" class="text-white hover:text-[#BF9B30]" data-i18n="nav-resources">Recursos</a>
            <a href="index.html#services" class="text-white hover:text-[#BF9B30]" data-i18n="nav-services">Servicios</a>
            <a href="index.html#sermones" class="text-white hover:text-[#BF9B30]" data-i18n="nav-sermons">Sermones</a>
            <a href="index.html#eventos" class="text-white hover:text-[#BF9B30]" data-i18n="nav-events">Eventos</a>
            <a href="index.html#contact" class="text-white hover:text-[#BF9B30]" data-i18n="nav-contact">Contacto</a>
        </div>

        <button id="lang-toggle" class="text-white border border-[#BF9B30] px-4 py-2 rounded hover:bg-[#BF9B30]">
            ES/EN
        </button>
    </nav>
</header>

<!-- ================= MAIN ================= -->
<section class="pt-32 pb-12 px-6 bg-gray-100">
    <div class="max-w-7xl mx-auto">

        <h1 class="text-4xl font-bold text-center mb-8 text-black" data-i18n="music-title">
            Música Cristiana
        </h1>

        <div class="mb-8 flex flex-col md:flex-row gap-4 justify-between items-center">
            <input id="search-input"
                   type="text"
                   placeholder="Buscar por nombre..."
                   class="w-full md:w-1/2 p-3 border border-gray-300 rounded focus:outline-none focus:border-[#BF9B30]">

            <select id="sort-select"
                    class="w-full md:w-1/4 p-3 border border-gray-300 rounded focus:outline-none focus:border-[#BF9B30]">
                <option value="desc">Más reciente primero</option>
                <option value="asc">Más antiguo primero</option>
            </select>
        </div>

        <div id="resource-grid" class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
            <!-- Música desde Google Drive -->
        </div>

    </div>
</section>

<!-- ================= FOOTER ================= -->
<footer class="bg-black text-white py-12 px-6">
    <div class="max-w-7xl mx-auto grid md:grid-cols-3 gap-8">

        <div>
            <h3 class="text-[#BF9B30] text-xl font-semibold mb-4">Ubicación</h3>
            <p>Cuenca, Ecuador</p>
        </div>

        <div>
            <h3 class="text-[#BF9B30] text-xl font-semibold mb-4">Contacto</h3>
            <p>Correo: contact@ibfb.org</p>
            <p>Teléfono: +593 123 456 789</p>
        </div>

        <div>
            <h3 class="text-[#BF9B30] text-xl font-semibold mb-4">Síguenos</h3>
            <div class="flex space-x-4">
                <a href="#" class="hover:text-[#BF9B30]">Facebook</a>
                <a href="#" class="hover:text-[#BF9B30]">YouTube</a>
                <a href="#" class="hover:text-[#BF9B30]">Instagram</a>
            </div>
        </div>

    </div>

    <div class="mt-8 text-center text-gray-400">
        © 2025 Iglesia Bautista Fundamental Betesda. Todos los derechos reservados.
    </div>
</footer>

<!-- ================= SCRIPT ================= -->
<script>
/* ===== CONFIG DRIVE ===== */
const API_KEY = "AIzaSyCGKNeb-D9-y7Ev1BdZGGq-lVmRViAB3VM";
const FOLDER_ID = "1Kvl7dYk9u4egds-VlYvP2jyhuxTG9v9-";

const resourceGrid = document.getElementById("resource-grid");
const searchInput = document.getElementById("search-input");
const sortSelect = document.getElementById("sort-select");

let resourceCards = [];

/* ===== CARGAR MP3 ===== */
async function cargarMusicaDrive() {
    const url = `https://www.googleapis.com/drive/v3/files?q='${FOLDER_ID}'+in+parents+and+mimeType='audio/mpeg'&fields=files(id,name,createdTime)&orderBy=createdTime desc&key=${API_KEY}`;

    const res = await fetch(url);
    const data = await res.json();

    resourceGrid.innerHTML = "";
    resourceCards = [];

    data.files.forEach(file => {
        const fecha = new Date(file.createdTime).toLocaleDateString("es-EC");

        const card = document.createElement("div");
        card.className = "resource-card bg-white rounded-lg shadow-lg p-6";
        card.dataset.name = file.name.toLowerCase();
        card.dataset.date = file.createdTime;

        card.innerHTML = `
            <h3 class="text-xl font-semibold mb-2">${file.name.replace(".mp3","")}</h3>
            <p class="text-gray-600 mb-4">Subido: ${fecha}</p>

            <audio controls preload="metadata" class="w-full mb-4">
                <source src="https://drive.google.com/uc?id=${file.id}" type="audio/mpeg">
            </audio>

            <a href="https://drive.google.com/uc?id=${file.id}&export=download"
               class="inline-block bg-[#BF9B30] text-white px-4 py-2 rounded hover:bg-black">
               Descargar MP3
            </a>
        `;

        resourceGrid.appendChild(card);
        resourceCards.push(card);
    });
}

/* ===== FILTRAR / ORDENAR ===== */
function filterAndSort() {
    const term = searchInput.value.toLowerCase();
    const order = sortSelect.value;

    let filtered = resourceCards.filter(c => c.dataset.name.includes(term));

    filtered.sort((a,b) => {
        const da = new Date(a.dataset.date);
        const db = new Date(b.dataset.date);
        return order === "asc" ? da - db : db - da;
    });

    resourceGrid.innerHTML = "";
    filtered.forEach(c => resourceGrid.appendChild(c));
}

searchInput.addEventListener("input", filterAndSort);
sortSelect.addEventListener("change", filterAndSort);

/* ===== INIT ===== */
cargarMusicaDrive();
</script>

</body>
</html>
